# Домашнее задание к занятию "Резервное копирование баз данных" - `Мильдзихов Сергей`


### Задание 1. Резервное копирование

Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.

Необходимо описать, какие варианты резервного копирования подходят в случаях:

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

### Ответ

В полном объеме: 

Для восстановления данных в полном объёме за предыдущий день подходит резервное копирование с использованием полной (full) или инкрементальной (incremental) стратегии. 

При использовании полной стратегии каждый день создается полная копия базы данных, что позволяет восстановить данные за любой день. 

При использовании инкрементальной стратегии создается копия только измененных данных за определенный период времени, что позволяет сократить время на создание копии и уменьшить объем хранимых данных.

За час:

Для восстановления данных за час до предполагаемой поломки подходит резервное копирование с использованием дифференциальной (differential) стратегии. 

При использовании дифференциальной стратегии каждый день создается копия всех изменений данных, которые произошли с момента последнего полного копирования. 

Таким образом, при восстановлении данных можно использовать последнюю полную копию и последнюю дифференциальную копию, чтобы получить актуальные данные на момент аварии. Это позволяет сократить время на восстановление данных и уменьшить объем хранимых данных по сравнению с полной стратегией.

### Задание 2. PostgreSQL

С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

### Ответ

Пример команды для создания резервной копии базы данных в PostgreSQL с помощью утилиты pg_dump:

pg_dump -U <username> -d <database_name> -F c -f backup_file.dump

Пример команды для восстановления базы данных из резервной копии с помощью утилиты pg_restore:

pg_restore -U <username> -d <database_name> backup_file.dump

ВАЖНО, чтобы перед выполнением команд необходимо убедиться, что утилиты pg_dump и pg_restore доступны в системе и находятся в переменной PATH

### Задание 3. MySQL

С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.

### Ответ

Для создания инкрементной резервной копии базы данных MySQL можно использовать утилиту mysqldump с параметром --single-transaction. Этот параметр позволяет создавать копию базы данных в режиме транзакции, что обеспечивает целостность данных и позволяет избежать блокировки таблиц при создании копии.

Пример команды для создания инкрементной резервной копии базы данных MySQL:

mysqldump --single-transaction --flush-logs --master-data=2 -u <username> -p <database_name> > backup_file.sql

где:
- --single-transaction - параметр, указывающий на создание копии базы данных в режиме транзакции;
- --flush-logs - параметр, указывающий на очистку журнала транзакций после создания копии;
- --master-data=2 - параметр, указывающий на добавление информации о бинарных логах и позиции бинарного лога в копию базы данных;
- -u <username> - имя пользователя MySQL;
- -p - параметр, указывающий на запрос пароля пользователя;
- <database_name> - имя базы данных, которую необходимо скопировать;
- > backup_file.sql - перенаправление вывода команды в файл backup_file.sql.

